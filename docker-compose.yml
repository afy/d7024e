services:
  node:
    build: .
    deploy:
      replicas: 20
    environment:
      IS_BOOTSTRAP_NODE: false
      BOOTSTRAP_PORT: ${PORT}
      PORT: ${PORT}
      BOOTSTRAP_NODE_ID: ${BOOTSTRAP_NODE_ID}
    depends_on:
      - bootstrap-node
    ports:
      - ${PORT}
    volumes:
      - .:/app
  bootstrap-node:
    build: .
    ports:
      - ${PORT}:${PORT}
    environment:
      IS_BOOTSTRAP_NODE: true
      BOOTSTRAP_PORT: ${PORT}
      PORT: ${PORT}
      BOOTSTRAP_NODE_ID: ${BOOTSTRAP_NODE_ID}
